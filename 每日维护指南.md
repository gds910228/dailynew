# 每日新知识汇 - 每日维护完整指南

## 📋 目录
1. [快速诊断](#快速诊断)
2. [每日维护流程](#每日维护流程)
3. [图片上传方案](#图片上传方案)
4. [后台管理使用](#后台管理使用)
5. [便捷方案推荐](#便捷方案推荐)
6. [常见问题排查](#常见问题排查)

---

## 🔍 快速诊断

### 小程序显示空白或无数据？

**检查清单：**

1. **确认GitHub数据文件可访问**
   - 在浏览器打开：https://raw.githubusercontent.com/gds910228/dailynew/main/data/articles.json
   - 如果显示JSON数据 → 正常
   - 如果显示404 → 需要提交数据文件

2. **确认微信域名白名单已配置**
   - 登录 https://mp.weixin.qq.com/
   - 开发 → 开发管理 → 开发设置
   - 服务器域名 → request合法域名
   - 必须包含：`https://raw.githubusercontent.com`

3. **确认已配置域名白名单或在开发模式**
   - 微信开发者工具 → 详情 → 本地设置
   - 勾选 ✅ **不校验合法域名**（仅开发阶段）

---

## 📅 每日维护流程

### 方案选择
- **方案A**：使用Web管理后台（推荐，适合每日更新）
- **方案B**：手动编辑JSON文件（适合技术用户）

---

## 方案A：使用Web管理后台（推荐）

### 步骤1：打开Web管理后台

**方法1：本地运行（推荐）**
```bash
# 进入admin目录
cd admin

# 使用Python启动临时服务器
python -m http.server 8000

# 或使用Python 3
python -m http.server 8000
```

然后在浏览器访问：http://localhost:8000

**方法2：使用VSCode Live Server**
1. 在VSCode中打开项目
2. 安装 "Live Server" 插件
3. 右键点击 `admin/index.html`
4. 选择 "Open with Live Server"

**方法3：直接打开文件**
直接双击 `admin/index.html` 文件

---

### 步骤2：准备图片URL

#### 选项1：使用GitHub存储图片（推荐，稳定免费）

**步骤：**

1. **创建图片目录**
   ```bash
   cd D:\WorkProjects\AI\MiniProgram\dailynew
   mkdir -p assets/images
   ```

2. **重命名图片文件**
   - 格式：`YYYYMMDD序号.jpg`
   - 示例：`20250119001.jpg`, `20250119002.jpg`
   - 将图片文件复制到 `assets/images/` 目录

3. **提交到GitHub**
   ```bash
   git add assets/images/
   git commit -m "添加图片：2025-01-19"
   git push origin main
   ```

4. **获取图片URL**
   - 格式：`https://raw.githubusercontent.com/gds910228/dailynew/main/assets/images/文件名.jpg`
   - 示例：`https://raw.githubusercontent.com/gds910228/dailynew/main/assets/images/20250119001.jpg`

5. **测试URL**
   - 在浏览器打开URL，确保能看到图片

#### 选项2：使用免费图床

**推荐图床：**

1. **ImgBB**（推荐，无需注册）
   - 访问：https://imgbb.com/
   - 上传图片
   - 复制"Direct link" URL
   - 粘贴到Web后台

2. **Postimages**（推荐，永久存储）
   - 访问：https://postimages.org/
   - 上传图片
   - 选择"Hotlink for websites"
   - 复制"Direct link" URL

---

### 步骤3：在Web后台添加文章

1. **填写表单**
   - **文章标题**：例如 "半导体设备：台积电扩产，国产替代加速"
   - **文章简述**：核心内容（1-2句话）
   - **原图URL**：粘贴图片URL（从步骤2获取）
   - **分类**：选择分类（如"半导体"）
   - **标签**：输入标签后按回车（至少1个，如"半导体"）
   - **发布日期**：默认今天
   - **作者**：默认"每日新知识汇"

2. **点击"提交文章"**
   - 系统自动提交到GitHub
   - 显示"文章发布成功"

---

### 步骤4：验证发布

1. **测试数据更新**
   - 浏览器访问：https://raw.githubusercontent.com/gds910228/dailynew/main/data/articles.json
   - 确认新文章已添加

2. **小程序查看**
   - 打开小程序
   - 下拉刷新
   - 查看新文章

---

## 方案B：手动编辑JSON文件

### 步骤1：编辑数据文件

1. **打开文件**
   - 使用文本编辑器打开 `data/articles.json`

2. **添加新文章**
   ```json
   {
     "id": "20250119001",
     "title": "文章标题",
     "description": "文章简述",
     "imageUrl": "图片URL",
     "thumbnailUrl": "缩略图URL",
     "tags": ["标签1", "标签2"],
     "category": "分类",
     "publishDate": "2025-01-19",
     "videoId": "",
     "author": "每日新知识汇",
     "viewCount": 0,
     "downloadCount": 0,
     "favoriteCount": 0
   }
   ```

3. **更新元数据**
   - `lastUpdate`: 当前日期
   - `totalCount`: 文章总数

### 步骤2：提交到GitHub

```bash
git add data/articles.json
git commit -m "更新文章数据：2025-01-19"
git push origin main
```

### 步骤3：验证

同方案A步骤4

---

## 🖼️ 图片上传方案对比

| 方案 | 优点 | 缺点 | 推荐度 |
|------|------|------|--------|
| **GitHub存储** | 完全免费、永久稳定、速度快 | 需要git操作 | ⭐⭐⭐⭐⭐ |
| **ImgBB** | 无需注册、操作简单 | 有流量限制 | ⭐⭐⭐⭐ |
| **Postimages** | 永久存储、速度快 | 需要等待上传 | ⭐⭐⭐⭐ |
| **SM.MS** | 曾经很好用 | 已停止注册 | ⭐ |

---

## 💻 后台管理使用

### Web后台功能说明

**位置：** `admin/index.html`

**主要功能：**
1. ✅ 添加新文章
2. ✅ 图片上传（需要图床Token）
3. ✅ 自动生成文章ID
4. ✅ 实时预览
5. ✅ 自动提交到GitHub

**配置：** `admin/config.js`
```javascript
const CONFIG = {
  githubToken: '你的Token',        // ✅ 已配置
  githubOwner: 'gds910228',       // ✅ 已配置
  githubRepo: 'dailynew',          // ✅ 已配置
  branch: 'main'                   // ✅ 已配置
};
```

**注意：** SM.MS图床Token无法获取，但**不影响使用**！只需要手动输入图片URL即可。

---

## 🚀 便捷方案推荐

### 推荐方案1：GitHub Desktop + GitHub存储

**适合人群：** 不熟悉命令行的用户

**步骤：**

1. **安装GitHub Desktop**
   - 下载：https://desktop.github.com/
   - 登录GitHub账号
   - 克隆仓库到本地

2. **日常维护流程**
   - 将图片放入 `assets/images/` 目录
   - 在GitHub Desktop中查看更改
   - 填写提交信息（如"添加图片：2025-01-19"）
   - 点击"Commit to main"
   - 点击"Push origin"

3. **获取图片URL**
   - 在GitHub网页打开仓库
   - 点击进入 `assets/images/` 目录
   - 点击图片文件
   - 点击"Download"或"Raw"
   - 复制URL（替换 `github.com` 为 `raw.githubusercontent.com`，去掉 `blob/`）

---

### 推荐方案2：VS Code + Live Server

**适合人群：** 熟悉VS Code的用户

**步骤：**

1. **安装VS Code**
   - 下载：https://code.visualstudio.com/

2. **安装插件**
   - Live Server（用于运行Web后台）
   - GitLens（增强Git功能）

3. **日常维护**
   - 在VS Code中打开项目
   - 右键 `admin/index.html` → "Open with Live Server"
   - 填写表单添加文章
   - 在VS Code中查看更改并提交

---

### 推荐方案3：纯在线操作（无需本地环境）

**适合人群：** 不想安装任何软件的用户

**工具：**
- GitHub网页版：https://github.com/
- ImgBB图床：https://imgbb.com/

**步骤：**

1. **上传图片到ImgBB**
   - 访问 https://imgbb.com/
   - 上传图片
   - 复制"Direct link"

2. **在GitHub上编辑数据文件**
   - 访问 https://github.com/gds910228/dailynew
   - 点击 `data/articles.json`
   - 点击铅笔图标 ✏️
   - 手动编辑JSON
   - 填写提交信息
   - 点击"Commit changes"

**缺点：** 需要手动编辑JSON，容易出错。

---

## 📝 每日维护检查清单

### 每天发布新文章时：

- [ ] 1. 准备图片文件
- [ ] 2. 上传图片到图床或GitHub
- [ ] 3. 复制图片URL
- [ ] 4. 打开Web管理后台（admin/index.html）
- [ ] 5. 填写文章信息（标题、描述、URL、标签等）
- [ ] 6. 点击"提交文章"
- [ ] 7. 验证GitHub数据已更新
- [ ] 8. 小程序下拉刷新测试

### 每周维护：

- [ ] 检查GitHub仓库大小
- [ ] 备份重要数据
- [ ] 查看用户反馈

---

## 🔧 常见问题排查

### Q1: 小程序显示空白，没有文章

**可能原因：**
1. GitHub数据文件不可访问
2. 域名白名单未配置
3. 数据文件为空或格式错误

**解决方法：**
```bash
# 1. 检查数据文件
curl https://raw.githubusercontent.com/gds910228/dailynew/main/data/articles.json

# 2. 如果404，重新提交数据文件
git add data/
git commit -m "更新数据文件"
git push origin main

# 3. 等待1-2分钟让CDN刷新
```

---

### Q2: Web后台无法提交数据

**可能原因：**
1. GitHub Token无效或过期
2. 网络问题
3. 文件已被修改（冲突）

**解决方法：**
1. 检查 `admin/config.js` 中的Token是否正确
2. 在浏览器开发者工具查看错误信息（F12）
3. 确保GitHub仓库有写入权限

---

### Q3: 图片无法显示

**可能原因：**
1. 图片URL错误
2. 图片文件过大
3. 图床有防盗链

**解决方法：**
1. 在浏览器直接打开图片URL测试
2. 图片大小建议小于2MB
3. 使用推荐的图床服务

---

### Q4: 如何批量上传图片？

**方法1：使用Git批量提交**
```bash
# 复制所有图片到目录
cp /path/to/images/*.jpg assets/images/

# 一次性提交
git add assets/images/
git commit -m "批量添加图片"
git push origin main
```

**方法2：使用GitHub Desktop**
- 直接拖拽多个图片文件到 `assets/images/` 目录
- 在GitHub Desktop中查看所有更改
- 一次性提交并推送

---

## 📞 获取帮助

**遇到问题？**

1. 查看本文档的"常见问题排查"章节
2. 查看项目根目录的其他文档：
   - `DEPLOYMENT.md` - 部署说明
   - `README.md` - 项目说明
   - `ICONS.md` - 图标说明

---

## 💡 最佳实践

### 内容管理
1. **图片命名规范**：`YYYYMMDD序号.jpg`
2. **文章ID规范**：`YYYYMMDD序号`（与图片对应）
3. **定期备份**：每月备份一次数据文件

### 性能优化
1. **图片压缩**：使用TinyPNG等工具压缩图片
2. **图片尺寸**：建议宽度800-1200px
3. **文件格式**：推荐使用JPG或WEBP

### 安全建议
1. **定期更新Token**：每6个月更新一次GitHub Token
2. **不要提交敏感信息**：检查.gitignore配置
3. **使用强密码**：GitHub账号使用强密码

---

**更新日期：** 2025-01-19
**维护者：** 每日新知识汇团队
