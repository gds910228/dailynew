# 每日更新流程说明

## 📁 文件夹结构（按日期分文件夹）

推荐使用日期文件夹来组织图片，便于管理和维护：

```
assets/images/
├── 20260116/
│   ├── 图片1.jpg
│   ├── 图片2.jpg
│   └── ...
├── 20260117/
│   ├── 图片1.jpg
│   └── ...
└── 20260119/
    ├── 价值-机器人、商航突破.jpg
    ├── 后花园-商航不止一波.jpg
    └── ...
```

## 🔄 每日更新步骤

### 步骤 1：创建日期文件夹并添加图片

```bash
# 在项目根目录执行
mkdir assets\images\20260120
```

然后将当天的所有图片复制到 `assets\images\20260120\` 文件夹中。

### 步骤 2：运行 URL 生成脚本

双击运行 `generate-urls-v2.bat`，或者在命令行执行：

```bash
python generate_urls_v2.py
```

脚本会自动：
- ✅ 扫描 `assets/images/` 下所有子文件夹
- ✅ 生成正确的 GitHub URL（包含子文件夹路径）
- ✅ 自动处理中文文件名（URL 编码）
- ✅ 询问是否上传图片到 GitHub
- ✅ 打开 Web 管理后台并自动填充 URL

### 步骤 3：上传图片到 GitHub

脚本会询问：
```
Upload images to GitHub first? (y/n):
```

选择 `y`，脚本会自动执行：
```bash
git add assets/images/
git commit -m "Add images"
git push origin main
```

### 步骤 4：在 Web 后台完善文章信息

脚本会自动打开 Web 管理后台，并已自动填充所有图片 URL。

你只需要：
1. 填写文章标题（如：`2026年1月20日`）
2. 填写描述信息
3. 选择发布日期
4. 点击提交

### 步骤 5：提交并推送 articles.json

Web 后台会更新 `data/articles.json` 文件。

推送到 GitHub：
```bash
git add data/articles.json
git commit -m "Update article for 2026-01-20"
git push origin main
```

### 步骤 6：验证小程序

打开微信小程序，下拉刷新，检查：
- ✅ 封面图能正常显示
- ✅ 文章详情能正常查看
- ✅ 所有图片能正常加载

## 📝 示例输出

运行脚本后，你会看到类似输出：

```
======================================================================
 Image URLs (Copy and Paste to Web Admin):
======================================================================

1. [20260120] 价值-机器人、商航突破.jpg
   https://raw.githubusercontent.com/gds910228/dailynew/main/assets/images/20260120/%E4%BB%B7%E5%80%BC-%E6%9C%BA%E5%99%A8%E4%BA%BA%E3%80%81%E5%95%86%E8%88%AA%E7%AA%81%E7%A0%B4.jpg

2. [20260120] 格兰-机器人、业绩超预期股.jpg
   https://raw.githubusercontent.com/gds910228/dailynew/main/assets/images/20260120/%E6%A0%BC%E5%85%B0-%E6%9C%BA%E5%99%A8%E4%BA%BA%E3%80%81%E4%B8%9A%E7%BB%A9%E8%B6%85%E9%A2%84%E6%9C%9F%E8%82%A1.jpg

...

======================================================================
 Total: 7 images
```

## ⚠️ 注意事项

### 1. 永远不要删除旧图片
除非：
- 已从 `articles.json` 中删除对应文章
- 且已推送到 GitHub

### 2. 文件命名规范
- ✅ 推荐：`2026012001.jpg`, `gl-17-openai.jpg`（英文）
- ⚠️ 可用：`价值-机器人.jpg`（中文，会自动 URL 编码）
- ❌ 避免：特殊字符、空格

### 3. 日期文件夹格式
推荐使用 8 位数字格式：
- `20260116`（2026年1月16日）
- `20260117`（2026年1月17日）

这样排序时会有序。

### 4. UTF-8 编码
确保 `articles.json` 使用 UTF-8 编码保存，避免中文乱码。

## 🚀 快速命令

如果你熟悉 Git 命令，可以手动执行：

```bash
# 1. 添加并上传图片
git add assets/images/
git commit -m "Add images for 2026-01-20"
git push origin main

# 2. 生成 URL 并更新 articles.json（通过 Web 后台）

# 3. 提交 articles.json
git add data/articles.json
git commit -m "Update article for 2026-01-20"
git push origin main
```

## 🔍 故障排查

### 问题：图片加载失败
**检查清单：**
1. 图片是否已推送到 GitHub？
2. `articles.json` 中的 URL 是否正确？
3. URL 是否正确编码（中文路径）？
4. 小程序网络连接是否正常？

### 问题：Web 后台无法打开
**解决方案：**
1. 检查 `admin/index.html` 是否存在
2. 检查 Python 是否安装
3. 手动在浏览器打开 `admin/index_temp.html`

### 问题：中文文件名乱码
**解决方案：**
1. 确保使用 UTF-8 编码
2. 脚本会自动进行 URL 编码
3. 使用英文文件名可避免问题

## 📌 总结

使用日期文件夹结构的优势：
- ✅ 清晰的组织结构
- ✅ 易于管理和维护
- ✅ 避免文件名冲突
- ✅ 方便备份和归档
- ✅ 支持多天内容并存

只需记住：**每天一个文件夹，脚本自动处理其余**。
