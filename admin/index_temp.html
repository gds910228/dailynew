<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¯æ—¥æ–°çŸ¥è¯†æ±‡ - å†…å®¹ç®¡ç†åå°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 14px;
        }

        .content {
            padding: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .tags-input-container {
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            padding: 8px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            min-height: 46px;
        }

        .tag-item {
            background: #667eea;
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .tag-item .remove-tag {
            cursor: pointer;
            font-weight: bold;
        }

        .tags-input {
            border: none;
            outline: none;
            flex: 1;
            min-width: 100px;
            font-size: 14px;
        }

        .btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
            margin-top: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .preview-section {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            display: none;
        }

        .preview-section.show {
            display: block;
        }

        .preview-section h3 {
            margin-bottom: 15px;
            color: #333;
        }

        .preview-image {
            max-width: 100%;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .loading.show {
            display: block;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .message {
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            display: none;
        }

        .message.show {
            display: block;
        }

        .message.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .message.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .config-section {
            background: #fff3cd;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #ffeeba;
        }

        .config-section h3 {
            color: #856404;
            margin-bottom: 10px;
        }

        .config-section p {
            color: #856404;
            font-size: 14px;
            line-height: 1.6;
        }

        .help-text {
            font-size: 12px;
            color: #6c757d;
            margin-top: 5px;
        }
    </style>

    <script>
    // é¢„å¡«å……æ•°æ® - åœ¨app.jsåŠ è½½ä¹‹å‰æ‰§è¡Œ
    window.__PRELOAD_URLS__ = `https://raw.githubusercontent.com/gds910228/dailynew/main/assets/images/GL-17%E5%8F%B7-OpenAI%E8%90%A5%E9%94%80%E3%80%81H200%E6%B8%85%E5%85%B3%E6%8E%A8%E6%BC%94.jpg\nhttps://raw.githubusercontent.com/gds910228/dailynew/main/assets/images/%E6%9F%B4%E5%A4%A7-AI%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD%E6%8B%BC%E5%9B%BE%E4%B9%8B%E4%B8%80-%E5%85%89%E4%BC%8F%E5%82%A8%E8%83%BD%E7%94%B5%E7%BD%91%E5%8F%AF%E6%8E%A7%E6%A0%B8%E8%81%9A%E5%8F%98.jpg\nhttps://raw.githubusercontent.com/gds910228/dailynew/main/assets/images/%E6%A0%BC%E5%85%B0-18%E5%8F%B7-%E7%BE%8E%E8%81%94%E5%82%A8%E4%B9%B1%E5%B1%80%E8%B5%84%E6%BA%90%E5%93%81%E3%80%81%E9%81%BF%E5%BC%80%E7%BA%AF%E9%A2%98%E6%9D%90%E7%82%92%E4%BD%9C%E5%95%86%E4%B8%9A%E8%88%AA%E5%A4%A9%E5%92%8CAI%E5%BA%94%E7%94%A8%E9%AB%98%E4%BD%8D%E8%82%A1.jpg\nhttps://raw.githubusercontent.com/gds910228/dailynew/main/assets/images/%E6%A0%BC%E5%85%B0-%E5%B8%82%E5%9C%BA.jpg\nhttps://raw.githubusercontent.com/gds910228/dailynew/main/assets/images/%E7%8C%AB%E7%AC%94%E5%88%80-%E6%85%A2%E7%89%9B%E5%B0%91%E5%8A%A8%E5%A4%9A%E7%9C%8B%E4%B8%9A%E7%BB%A9%E4%B8%BA%E7%8E%8B.jpg\nhttps://raw.githubusercontent.com/gds910228/dailynew/main/assets/images/%E8%B0%83%E7%A0%94-%E5%AD%98%E5%82%A8%E6%8C%81%E7%BB%AD%E6%80%A7%E3%80%81%E6%9C%BA%E5%99%A8%E4%BA%BA%E7%89%B9%E6%96%AF%E6%8B%89%E6%94%B6%E7%9B%8A%E6%A0%87%E7%9A%84.jpg`;
    console.log('âœ… URLs pre-loaded:', 6, 'URLs');
    </script>
    
    <!-- åŠ è½½é…ç½®æ–‡ä»¶ -->
    <script src="config.local.js" onerror="this.src='config.js'"></script>
    <!-- åŠ è½½app.js -->
    <script src="app.js"></script>
    <script>
    // app.jsåŠ è½½å®Œæˆåï¼Œæ£€æŸ¥æ˜¯å¦æœ‰é¢„å¡«å……çš„URL
    window.addEventListener('load', function() {
        if (window.__PRELOAD_URLS__) {
            setTimeout(function() {
                const textarea = document.getElementById('imageUrl');
                if (textarea && !textarea.value) {
                    textarea.value = window.__PRELOAD_URLS__;
                    // è§¦å‘inputäº‹ä»¶ä»¥æ›´æ–°é¢„è§ˆ
                    textarea.dispatchEvent(new Event('input', { bubbles: true }));
                    console.log('âœ… URLs auto-filled to textarea');

                    // æ˜¾ç¤ºæç¤ºæ¶ˆæ¯
                    const messageDiv = document.getElementById('message');
                    if (messageDiv) {
                        const urlCount = window.__PRELOAD_URLS__.split('\n').filter(u => u.trim()).length;
                        messageDiv.textContent = `âœ… å·²è‡ªåŠ¨åŠ è½½ ${urlCount} ä¸ªå›¾ç‰‡URL`;
                        messageDiv.className = 'message show success';
                        setTimeout(() => {
                            messageDiv.className = 'message';
                        }, 3000);
                    }
                }
            }, 100); // å»¶è¿Ÿ100msç¡®ä¿app.jsåˆå§‹åŒ–å®Œæˆ
        }
    });
    </script>
    </head>
<body>
    <div class="container">
        <div class="header">
            <h1>æ¯æ—¥æ–°çŸ¥è¯†æ±‡ - å†…å®¹ç®¡ç†åå°</h1>
            <p>æ·»åŠ æ–°æ–‡ç« å¹¶è‡ªåŠ¨åŒæ­¥åˆ°GitHub</p>
        </div>

        <div class="content">
            <!-- é…ç½®è¯´æ˜ -->
            <div class="config-section">
                <h3>âš ï¸ ä½¿ç”¨å‰é…ç½®</h3>
                <p>é¦–æ¬¡ä½¿ç”¨è¯·ç¼–è¾‘ <code>admin/config.js</code> æ–‡ä»¶ï¼Œå¡«å…¥ä½ çš„ GitHub Token å’Œä»“åº“ä¿¡æ¯ã€‚</p>
            </div>

            <!-- æ¶ˆæ¯æç¤º -->
            <div id="message" class="message"></div>

            <!-- åŠ è½½æç¤º -->
            <div id="loading" class="loading">
                <div class="spinner"></div>
                <p style="margin-top: 10px;">æ­£åœ¨æäº¤åˆ°GitHub...</p>
            </div>

            <!-- æ–‡ç« è¡¨å• -->
            <form id="articleForm">
                <div class="form-group">
                    <label for="title">æ–‡ç« æ ‡é¢˜ *</label>
                    <input type="text" id="title" required placeholder="ä¾‹å¦‚ï¼šåŠå¯¼ä½“è®¾å¤‡ï¼šå°ç§¯ç”µæ‰©äº§ï¼Œå›½äº§æ›¿ä»£åŠ é€Ÿ">
                </div>

                <div class="form-group">
                    <label for="description">æ–‡ç« ç®€è¿° *</label>
                    <textarea id="description" required placeholder="æ ¸å¿ƒå‚¬åŒ–å› ç´ ï¼ˆ1-2å¥è¯ï¼‰"></textarea>
                </div>

                <div class="form-group">
                    <label>å›¾ç‰‡URL * <span style="font-weight: normal; color: #666;">ï¼ˆæ”¯æŒå¤šå¼ å›¾ç‰‡ï¼Œæ¯è¡Œä¸€ä¸ªURLï¼‰</span></label>
                    <textarea id="imageUrl" required placeholder="https://example.com/image1.jpg&#10;https://example.com/image2.jpg&#10;https://example.com/image3.jpg" style="min-height: 120px;"></textarea>
                    <p class="help-text">æ¯è¡Œå¡«å†™ä¸€ä¸ªå›¾ç‰‡URLï¼Œç¬¬ä¸€å¼ å°†ä½œä¸ºå°é¢å›¾</p>
                </div>

                <div class="form-group">
                    <label for="category">åˆ†ç±»ï¼ˆå¯é€‰ï¼‰</label>
                    <select id="category">
                        <option value="">è¯·é€‰æ‹©åˆ†ç±»</option>
                        <option value="åŠå¯¼ä½“">åŠå¯¼ä½“</option>
                        <option value="AIç¡¬ä»¶">AIç¡¬ä»¶</option>
                        <option value="å­˜å‚¨èŠ¯ç‰‡">å­˜å‚¨èŠ¯ç‰‡</option>
                        <option value="æ–°èƒ½æº">æ–°èƒ½æº</option>
                        <option value="æ¶ˆè´¹ç”µå­">æ¶ˆè´¹ç”µå­</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>æ ‡ç­¾ï¼ˆå¯é€‰ï¼‰</label>
                    <div class="tags-input-container" id="tagsContainer">
                        <input type="text" class="tags-input" id="tagsInput" placeholder="è¾“å…¥æ ‡ç­¾åæŒ‰å›è½¦">
                    </div>
                    <p class="help-text">è¾“å…¥æ ‡ç­¾åæŒ‰Enteræ·»åŠ ï¼Œå»ºè®®æ·»åŠ 2-3ä¸ªæ ‡ç­¾ä¾¿äºæœç´¢</p>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="videoId">è§†é¢‘å·ID</label>
                        <input type="text" id="videoId" placeholder="å¯é€‰ï¼Œå…³è”è§†é¢‘å·">
                    </div>
                    <div class="form-group">
                        <label for="publishDate">å‘å¸ƒæ—¥æœŸ *</label>
                        <input type="date" id="publishDate" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="author">ä½œè€… *</label>
                    <input type="text" id="author" required value="æ¯æ—¥æ–°çŸ¥è¯†æ±‡">
                </div>

                <button type="submit" class="btn">æäº¤æ–‡ç« </button>
            </form>

            <!-- é¢„è§ˆåŒºåŸŸ -->
            <div id="previewSection" class="preview-section">
                <h3>ğŸ“‹ æ–‡ç« é¢„è§ˆ</h3>
                <img id="previewImage" class="preview-image" src="" alt="é¢„è§ˆå›¾ç‰‡">
                <p><strong>æ ‡é¢˜ï¼š</strong><span id="previewTitle"></span></p>
                <p><strong>åˆ†ç±»ï¼š</strong><span id="previewCategory"></span></p>
                <p><strong>æ ‡ç­¾ï¼š</strong><span id="previewTags"></span></p>
                <p><strong>æ—¥æœŸï¼š</strong><span id="previewDate"></span></p>
            </div>
        </div>
    </div>

    <script>
        // è‡ªåŠ¨å¡«å……å›¾ç‰‡URLåŠŸèƒ½ - ä»URLå‚æ•°è¯»å–
        (function() {
            // ç­‰å¾…DOMåŠ è½½å®Œæˆ
            document.addEventListener('DOMContentLoaded', function() {
                try {
                    // ä»URLå‚æ•°ä¸­è·å–ç¼–ç çš„URLåˆ—è¡¨
                    const urlParams = new URLSearchParams(window.location.search);
                    const urlsParam = urlParams.get('urls');

                    console.log('ğŸ” URLs parameter found:', urlsParam ? 'Yes' : 'No');
                    console.log('ğŸ” Full URL:', window.location.href);

                    if (urlsParam) {
                        // å…ˆè§£ç URLç¼–ç ï¼Œå†Base64è§£ç 
                        const urlDecoded = decodeURIComponent(urlsParam);
                        const decodedUrls = atob(urlDecoded);

                        console.log('âœ… URLs decoded successfully, length:', decodedUrls.length);

                        // å¡«å……URLåˆ°textarea
                        const imageUrlTextarea = document.getElementById('imageUrl');
                        if (imageUrlTextarea && decodedUrls) {
                            imageUrlTextarea.value = decodedUrls;

                            // è®¡ç®—URLæ•°é‡
                            const urlCount = decodedUrls.split('\n').filter(url => url.trim()).length;

                            // æ˜¾ç¤ºæˆåŠŸæç¤º
                            const messageDiv = document.getElementById('message');
                            if (messageDiv) {
                                messageDiv.textContent = `âœ… å·²è‡ªåŠ¨åŠ è½½ ${urlCount} ä¸ªå›¾ç‰‡URL`;
                                messageDiv.className = 'message success show';
                                // 3ç§’åè‡ªåŠ¨éšè—
                                setTimeout(() => {
                                    messageDiv.className = 'message';
                                }, 3000);
                            }

                            console.log('âœ… URLs auto-filled:', urlCount, 'URLs');
                        }
                    } else {
                        console.log('â„¹ï¸ No URLs parameter found in URL');
                    }
                } catch (error) {
                    console.error('âŒ Error processing URLs:', error);
                    console.error('Error details:', error.message);
                }
            });
        })();

        // ä¼˜å…ˆåŠ è½½æœ¬åœ°é…ç½®æ–‡ä»¶ï¼ˆå®‰å…¨ï¼‰ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™åŠ è½½é»˜è®¤é…ç½®
        (function() {
            const configScript = document.createElement('script');
            configScript.onerror = function() {
                // config.local.jsä¸å­˜åœ¨ï¼ŒåŠ è½½é»˜è®¤config.js
                const defaultScript = document.createElement('script');
                defaultScript.src = 'config.js';
                defaultScript.onload = function() {
                    // åŠ è½½app.js
                    const appScript = document.createElement('script');
                    appScript.src = 'app.js';
                    document.body.appendChild(appScript);
                };
                document.body.appendChild(defaultScript);
            };
            configScript.onload = function() {
                // config.local.jsåŠ è½½æˆåŠŸï¼ŒåŠ è½½app.js
                const appScript = document.createElement('script');
                appScript.src = 'app.js';
                document.body.appendChild(appScript);
            };
            configScript.src = 'config.local.js';
            document.body.appendChild(configScript);
        })();
    </script>
</body>
</html>
