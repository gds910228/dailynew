<!--pages/profile/profile.wxml-->
<view class="container">
  <!-- 顶部用户信息区 -->
  <view class="header">
    <view class="user-info">
      <image class="avatar" src="/assets/icons/app-icon-v3.svg" mode="aspectFit"></image>
      <view class="app-name">每日新知识汇</view>
      <view class="app-desc">前沿财经资讯整理工具</view>
    </view>
  </view>

  <!-- 统计数据 -->
  <view class="stats-card">
    <view class="stat-item">
      <text class="stat-num">{{stats.favoriteCount}}</text>
      <text class="stat-label">收藏</text>
    </view>
    <view class="stat-divider"></view>
    <view class="stat-item">
      <text class="stat-num">{{stats.historyCount}}</text>
      <text class="stat-label">浏览</text>
    </view>
    <view class="stat-divider"></view>
    <view class="stat-item">
      <text class="stat-num">{{lastUpdateText}}</text>
      <text class="stat-label">最后更新</text>
    </view>
  </view>

  <!-- 标签切换 -->
  <view class="tabs">
    <view
      class="tab-item {{currentTab === 0 ? 'active' : ''}}"
      bindtap="onTabChange"
      data-tab="0"
    >
      我的收藏
    </view>
    <view
      class="tab-item {{currentTab === 1 ? 'active' : ''}}"
      bindtap="onTabChange"
      data-tab="1"
    >
      浏览历史
    </view>
  </view>

  <!-- 内容列表 -->
  <view class="content-list">
    <!-- 收藏列表 -->
    <view wx:if="{{currentTab === 0}}">
      <!-- 空状态 -->
      <view wx:if="{{favorites.length === 0}}" class="empty-state">
        <image class="empty-icon" src="/assets/icons/empty-favorite.png" mode="aspectFit"></image>
        <text class="empty-text">暂无收藏内容</text>
      </view>

      <!-- 收藏文章列表 -->
      <view
        wx:for="{{favorites}}"
        wx:key="id"
        class="list-item"
        bindtap="onArticleTap"
        data-id="{{item.id}}"
      >
        <image class="item-thumb" src="{{item.thumbnailUrl}}" mode="aspectFill"></image>
        <view class="item-content">
          <view class="item-title">{{item.title}}</view>
          <view class="item-meta">
            <text class="item-category">{{item.category}}</text>
            <text class="item-time">{{item.favoriteTime}}</text>
          </view>
        </view>
        <image
          class="delete-btn"
          src="/assets/icons/delete.png"
          catchtap="onRemoveFavorite"
          data-id="{{item.id}}"
          mode="aspectFit"
        ></image>
      </view>
    </view>

    <!-- 历史记录列表 -->
    <view wx:if="{{currentTab === 1}}">
      <!-- 空状态 -->
      <view wx:if="{{history.length === 0}}" class="empty-state">
        <image class="empty-icon" src="/assets/icons/empty-history.png" mode="aspectFit"></image>
        <text class="empty-text">暂无浏览记录</text>
      </view>

      <!-- 历史文章列表 -->
      <view
        wx:for="{{history}}"
        wx:key="id"
        class="list-item"
        bindtap="onArticleTap"
        data-id="{{item.id}}"
      >
        <image class="item-thumb" src="{{item.thumbnailUrl}}" mode="aspectFill"></image>
        <view class="item-content">
          <view class="item-title">{{item.title}}</view>
          <view class="item-meta">
            <text class="item-category">{{item.category}}</text>
            <text class="item-time">{{item.viewTime}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- 清空历史按钮 -->
  <view wx:if="{{currentTab === 1 && history.length > 0}}" class="clear-btn" bindtap="onClearHistory">
    <text>清空浏览历史</text>
  </view>

  <!-- 免责声明 -->
  <view class="footer-disclaimer">
    <text>本内容仅为个人学习笔记，不构成投资建议</text>
  </view>
</view>
