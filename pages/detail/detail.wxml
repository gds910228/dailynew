<!--pages/detail/detail.wxml-->
<view class="container">
  <!-- å›¾ç‰‡å±•ç¤ºåŒº - æ”¯æŒå¤šå›¾è½®æ’­ -->
  <view class="image-container" wx:if="{{article}}">
    <swiper
      wx:if="{{article.imageUrls && article.imageUrls.length > 0}}"
      class="image-swiper"
      indicator-dots="{{article.imageUrls.length > 1}}"
      indicator-color="rgba(255, 255, 255, 0.5)"
      indicator-active-color="#fff"
      autoplay="{{false}}"
      current="{{currentImageIndex}}"
      bindchange="onImageChange"
    >
      <swiper-item wx:for="{{article.imageUrls}}" wx:key="index">
        <image
          class="article-image"
          src="{{item}}"
          mode="aspectFill"
          bindtap="onPreviewImage"
          data-index="{{index}}"
          lazy-load="{{true}}"
          binderror="onImageError"
        ></image>
      </swiper-item>
    </swiper>

    <!-- å•å›¾æ˜¾ç¤ºï¼ˆå…¼å®¹æ—§æ•°æ®ï¼‰ -->
    <image
      wx:elif="{{article.imageUrl}}"
      class="article-image"
      src="{{article.imageUrl}}"
      mode="aspectFill"
      bindtap="onPreviewImage"
      lazy-load="{{true}}"
    ></image>

    <!-- æ— å›¾ç‰‡æç¤º -->
    <view wx:else class="no-image">
      <text>æš‚æ— å›¾ç‰‡</text>
    </view>

    <!-- å›¾ç‰‡è®¡æ•°å™¨ -->
    <view wx:if="{{article.imageUrls && article.imageUrls.length > 1}}" class="image-counter">
      {{currentImageIndex + 1}} / {{article.imageUrls.length}}
    </view>
  </view>

  <!-- å†…å®¹åŒº -->
  <view class="content-container" wx:if="{{article}}">
    <!-- æ ‡é¢˜ -->
    <view class="title">{{article.title || ''}}</view>

    <!-- å…ƒä¿¡æ¯ -->
    <view class="meta-info">
      <text class="category">{{article.category || 'æœªåˆ†ç±»'}}</text>
      <text class="date">{{article.publishDate || ''}}</text>
      <text class="author">{{article.author || ''}}</text>
    </view>

    <!-- æ ‡ç­¾ -->
    <view class="tags" wx:if="{{article.tags && article.tags.length > 0}}">
      <view
        wx:for="{{article.tags}}"
        wx:key="index"
        class="tag"
      >
        #{{item}}
      </view>
    </view>

    <!-- æè¿° -->
    <view class="description">{{article.description || ''}}</view>

    <!-- åˆ†äº«å¼•å¯¼ -->
    <view class="share-tip">
      <text>ğŸ’¡ å»ºè®®æ¨ªå±æŸ¥çœ‹ï¼Œé•¿æŒ‰å›¾ç‰‡å¯ä¿å­˜åˆ°ç›¸å†Œ</text>
    </view>
  </view>

  <!-- åº•éƒ¨æ“ä½œæ  -->
  <view class="action-bar" wx:if="{{article}}">
    <view class="action-btn" bindtap="onFavorite">
      <image
        class="action-icon"
        src="{{isFavorited ? '/assets/icons/heart-active.png' : '/assets/icons/heart.png'}}"
        mode="aspectFit"
      ></image>
      <text>{{isFavorited ? 'å·²æ”¶è—' : 'æ”¶è—'}}</text>
    </view>

    <view class="action-btn" bindtap="onDownload">
      <image class="action-icon" src="/assets/icons/download.png" mode="aspectFit"></image>
      <text>ä¸‹è½½åŸå›¾</text>
    </view>

    <button class="action-btn share-btn" open-type="share">
      <image class="action-icon" src="/assets/icons/share.png" mode="aspectFit"></image>
      <text>åˆ†äº«</text>
    </button>

    <view wx:if="{{article.videoId && article.videoId !== ''}}" class="action-btn" bindtap="onWatchVideo">
      <image class="action-icon" src="/assets/icons/video.png" mode="aspectFit"></image>
      <text>çœ‹è§†é¢‘</text>
    </view>
  </view>

  <!-- å…è´£å£°æ˜ -->
  <view class="disclaimer">
    <text>æœ¬å†…å®¹ä»…ä¸ºä¸ªäººå­¦ä¹ ç¬”è®°ï¼Œä¸æ„æˆæŠ•èµ„å»ºè®®</text>
  </view>
</view>
